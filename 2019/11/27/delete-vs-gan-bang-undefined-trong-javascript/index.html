<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="vietduc01100001 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="vietduc01100001 Blog Atom Feed"><title data-react-helmet="true">delete vs gán bằng undefined trong JavaScript | vietduc01100001</title><meta data-react-helmet="true" property="og:title" content="delete vs gán bằng undefined trong JavaScript | vietduc01100001"><meta data-react-helmet="true" name="description" content="Đã bao giờ bạn xóa một property khỏi object trong JavaScript chưa? Bạn sử dụng cách nào? Bạn có muốn biết sự khác biệt giữa những cách đó? Bài viết này sẽ giúp bạn giải thích những thắc mắc trên."><meta data-react-helmet="true" property="og:description" content="Đã bao giờ bạn xóa một property khỏi object trong JavaScript chưa? Bạn sử dụng cách nào? Bạn có muốn biết sự khác biệt giữa những cách đó? Bài viết này sẽ giúp bạn giải thích những thắc mắc trên."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.f6fca80d.css">
<link rel="preload" href="/styles.72b184dc.js" as="script">
<link rel="preload" href="/runtime~main.dced0446.js" as="script">
<link rel="preload" href="/main.1cfe4ebb.js" as="script">
<link rel="preload" href="/1.b01f7002.js" as="script">
<link rel="preload" href="/2.d3f49370.js" as="script">
<link rel="preload" href="/ccc49370.fe0e3eb8.js" as="script">
<link rel="preload" href="/c40d0d7b.e7ea03b1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_OaSq"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="logo"><strong class="navbar__title">vietduc01100001</strong></a><a class="navbar__item navbar__link" href="/projects">Projects</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">About me</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Links</a><ul class="dropdown__menu"><li><a href="https://www.linkedin.com/in/vietduc01100001" target="_blank" rel="noopener noreferrer" class="dropdown__link">LinkedIn</a></li><li><a href="https://github.com/vietduc01100001" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub</a></li><li><a href="https://stackoverflow.com/users/8943850/duc-nguyen" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="logo"><strong class="navbar__title">vietduc01100001</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/projects">Projects</a></li><li class="menu__list-item"><a class="menu__link" href="/about">About me</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist">Links</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.linkedin.com/in/vietduc01100001" target="_blank" rel="noopener noreferrer" class="menu__link">LinkedIn</a></li><li class="menu__list-item"><a href="https://github.com/vietduc01100001" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://stackoverflow.com/users/8943850/duc-nguyen" target="_blank" rel="noopener noreferrer" class="menu__link">Stack Overflow</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_2RZH">delete vs gán bằng undefined trong JavaScript</h1><div class="margin-vert--md"><time datetime="2019-11-27T00:00:00.000Z" class="blogPostDate_3tRe">November 27, 2019  · 4 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>Đã bao giờ bạn xóa một property khỏi object trong JavaScript chưa? Bạn sử dụng cách nào? Bạn có muốn biết sự khác biệt giữa những cách đó? Bài viết này sẽ giúp bạn giải thích những thắc mắc trên.</p><p>Hôm nay đang code thì mình gặp trường hợp phải xoá một property trong object. Thoạt nhìn tưởng đơn giản mà lại chứa đựng những kiến thức không ngờ. 😱</p><p>Như các bạn đã biết, có 2 cách để &quot;xoá&quot; một property khỏi object trong JavaScript:</p><ol><li><p>Dùng <code>delete</code> operator</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">delete</span><span class="token plain"> foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">bar</span></div></div></div></div></div></li><li><p>Gán property cần xoá bằng <code>undefined</code></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">bar</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span></div></div></div></div></div></li></ol><p>Sau một hồi Google thần chưởng, mình có thể tóm tắt lại những điểm khác biệt giữa 2 cách trên.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="1-gán-property-bằng-undefined-không-hoàn-toàn-xoá-property-đó"></a>1. Gán property bằng <code>undefined</code> không hoàn toàn xoá property đó<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-gán-property-bằng-undefined-không-hoàn-toàn-xoá-property-đó" title="Direct link to heading">#</a></h2><p>Điều đầu tiên bạn nên biết là việc gán <code>foo.bar</code> bằng <code>undefined</code> chỉ đơn giản là cho property đó có giá trị là <code>undefined</code>. Có nghĩa là khi bạn sử dụng hàm <code>hasOwnProperty()</code> hoặc lặp object trong vòng lặp <code>for in</code> thì property vẫn còn tồn tại.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">hasOwnProperty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// returns true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> key </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;I am still alive&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// log `I am still a live`</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Nếu dùng <code>delete</code> operator thì property sẽ bị xoá hoàn toàn, và kết quả trong đoạn code trên sẽ bị đảo ngược.</p><p>Lí do là vì <code>delete</code> operator làm thay đổi <a href="https://thefullsnack.com/posts/javascript-v8-notes.html#hidden-class">hidden class</a>, tương đương với việc property <code>bar</code> chưa bao giờ được khai báo. Điều này không xảy ra khi gán <code>foo.bar</code> bằng <code>undefined</code>, vì thao tác này chỉ gán lại giá trị của property <code>bar</code>. Vì vậy nếu bạn muốn check trong object có tồn tại property nào đó không thì nên sử dụng hàm <code>hasOwnProperty()</code> hơn là một câu check đơn giản:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">bar</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Các bạn thử tìm hiểu sự khác biệt giữa <em>undefined</em> và <em>not defined</em> trong JavaScript nữa nhé, khá thú vị đấy! 😉</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="2-nếu-object-có-prototype-chain-thì-sao"></a>2. Nếu object có prototype chain thì sao?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-nếu-object-có-prototype-chain-thì-sao" title="Direct link to heading">#</a></h2><p>Mình có một ví dụ như sau:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> origin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> extended </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">origin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">extended</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">delete</span><span class="token plain"> extended</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">extended</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ???</span></div></div></div></div></div><p>Các bạn thử đoán xem đoạn code trên sẽ log ra cái gì?</p><p>Nếu bạn nghĩ kết quả là <code>undefined</code> thì xin chia buồn, hôm nay bạn tạch lô =))</p><p>Ở đây chúng ta có object <code>extended</code> có prototype là object <code>origin</code>. Sau khi gọi <code>delete</code> thì mỗi lần truy cập lại <code>extended.x</code> JavaScript engine sẽ look up từ prototype chain của <code>extended</code> và tìm thấy property <code>x</code> của <code>origin</code>. Kết quả trả về console là <code>1</code>.</p><p>OK đã rõ, vậy điều gì sẽ xảy ra khi thay 2 dòng cuối của đoạn code trên thành như sau:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">extended</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">extended</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ???</span></div></div></div></div></div><p>Lúc này kết quả log ra sẽ là <code>undefined</code>. Vì property <code>x</code> vẫn tồn tại trong <code>extended</code> với giá trị bằng <code>undefined</code> nên sẽ không xảy ra việc look up từ prototype chain.</p><p>Túm lại là khi bạn thực hiện &quot;xoá&quot; một property khỏi object, nếu không chắc chắn rằng object đó có prototype chain hay không và các object nó thừa hưởng prototype có chứa property cần xoá không, thì bạn nên gán nó bằng <code>undefined</code> thay vì dùng <code>delete</code> operator.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="3-tôi-có-một-con-máy-linux-với-cpu-08ghz-và-256mb-ram-tôi-quan-tâm-tới-performance"></a>3. &quot;Tôi có một con máy Linux với CPU 0.8GHz và 256MB RAM, tôi quan tâm tới performance!&quot;<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-tôi-có-một-con-máy-linux-với-cpu-08ghz-và-256mb-ram-tôi-quan-tâm-tới-performance" title="Direct link to heading">#</a></h2><p>Như đã đề cập ở phần 1, việc <code>delete</code> một property sẽ làm thay đổi hidden class, đồng nghĩa với performance bị ảnh hưởng. Bạn nên tránh sử dụng <code>delete</code> operator quá nhiều, đặc biệt ở trong vòng lặp. Tuy nhiên không có nghĩa là bạn không bao giờ nên dùng operator này. Việc optimize code ở mức JavaScript engine sẽ không đáng để đánh đổi nếu nó làm cho code của bạn đọc như văn tế.</p><p>Bài viết này đã giúp bạn hiểu được sự khác biệt giữa 2 cách xóa property khỏi object trong JavaScript. Hi vọng nó sẽ giúp bạn lên level để đi cà khịa với đồng nghiệp. 😎</p><p><em>Tham khảo từ:</em></p><ul><li><p><em><a href="https://stackoverflow.com/a/14967568/8943850" target="_blank" rel="noopener noreferrer">javascript - delete a.x vs a.x = undefined - Stack Overflow</a></em></p></li><li><p><em><a href="https://thefullsnack.com/posts/javascript-v8-notes.html#hidden-class">Vài ghi chép về V8 và Garbage Collection | Huy&#x27;s Blog</a></em></p></li></ul></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/tags/javascript">javascript</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/2019/12/23/review-sach-the-little-go-book"><div class="pagination-nav__sublabel">Previous Post</div><div class="pagination-nav__label">« Review sách The Little Go Book</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 vietduc01100001</div></div></div></footer></div>
<script src="/styles.72b184dc.js"></script>
<script src="/runtime~main.dced0446.js"></script>
<script src="/main.1cfe4ebb.js"></script>
<script src="/1.b01f7002.js"></script>
<script src="/2.d3f49370.js"></script>
<script src="/ccc49370.fe0e3eb8.js"></script>
<script src="/c40d0d7b.e7ea03b1.js"></script>
</body>
</html>