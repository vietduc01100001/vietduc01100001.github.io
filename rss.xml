<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Duck Who Codes - Blog by Duc Nguyen]]></title><description><![CDATA[Blog by Duc Nguyen - Software Engineer. Making the world better with code.]]></description><link>https://duckwho.codes</link><generator>GatsbyJS</generator><lastBuildDate>Mon, 31 May 2021 10:52:31 GMT</lastBuildDate><item><title><![CDATA[Exponential backoff]]></title><description><![CDATA[What I learned about exponential backoff.]]></description><link>https://duckwho.codes/posts/exponential-backoff/</link><guid isPermaLink="false">https://duckwho.codes/posts/exponential-backoff/</guid><pubDate>Thu, 29 Apr 2021 04:30:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;what-is-exponential-backoff&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#what-is-exponential-backoff&quot; aria-label=&quot;what is exponential backoff permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;What is exponential backoff?&lt;/h2&gt;
&lt;p&gt;Exponential backoff is an algorithm often used in network applications for error handling. It’s a strategy where a client periodically retries a failed request with increasing delays between requests. The best way to understand this algorithm is to look at an example:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A client makes a request to a server.&lt;/li&gt;
&lt;li&gt;If the request fails, wait &lt;code class=&quot;language-text&quot;&gt;1 + random&lt;/code&gt; seconds and retry.&lt;/li&gt;
&lt;li&gt;If the request fails, wait &lt;code class=&quot;language-text&quot;&gt;2 + random&lt;/code&gt; seconds and retry.&lt;/li&gt;
&lt;li&gt;If the request fails, wait &lt;code class=&quot;language-text&quot;&gt;4 + random&lt;/code&gt; seconds and retry.&lt;/li&gt;
&lt;li&gt;If the request fails, wait &lt;code class=&quot;language-text&quot;&gt;8 + random&lt;/code&gt; seconds and retry.&lt;/li&gt;
&lt;li&gt;And so on, up to a &lt;code class=&quot;language-text&quot;&gt;maximum backoff&lt;/code&gt; time.&lt;/li&gt;
&lt;li&gt;Continue to retry up to a maximum number of retries, but not increasing the delay.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As you can see, the delay between each request grows exponentially plus a &lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt; number. But what is that number? It’s called &lt;em&gt;jitter&lt;/em&gt;, usually much smaller than the main delay (in milliseconds). The reason it’s random is to avoid retried requests hitting the server at the same time.&lt;/p&gt;
&lt;h2 id=&quot;how-can-i-implement-it&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#how-can-i-implement-it&quot; aria-label=&quot;how can i implement it permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How can I implement it?&lt;/h2&gt;
&lt;p&gt;It’s fairly simple to implement exponential backoff. You can work it out yourself by looking at the example.&lt;/p&gt;
&lt;p&gt;Here is the formula to calculate the delay on each request.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;delay = min(((2^retry_count) + small_random_number), maximum_backoff)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Where:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;retry_count&lt;/code&gt; increments by 1 for each request.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;small_random_number&lt;/code&gt; is random for each request (you can choose somewhere between 0-20% of &lt;code class=&quot;language-text&quot;&gt;2^retry_count&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;maximum_backoff&lt;/code&gt; is the maximum delay.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;why-should-i-use-it&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#why-should-i-use-it&quot; aria-label=&quot;why should i use it permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Why should I use it?&lt;/h2&gt;
&lt;p&gt;Exponential backoff spaces out retries, reduces burst requests coming to the servers, which leads to more reliable error handling.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;References:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Exponential Backoff And Jitter | AWS Architecture Blog&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://cloud.google.com/iot/docs/how-tos/exponential-backoff&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Implementing exponential backoff  |  Cloud IoT Core Documentation&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[esModuleInterop]]></title><description><![CDATA[What I learned about the esModuleInterop option in TypeScript.]]></description><link>https://duckwho.codes/posts/esmoduleinterop/</link><guid isPermaLink="false">https://duckwho.codes/posts/esmoduleinterop/</guid><pubDate>Mon, 26 Apr 2021 04:30:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;the-problem&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#the-problem&quot; aria-label=&quot;the problem permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;The problem&lt;/h2&gt;
&lt;p&gt;So I was working on a TypeScript codebase where I needed to create a new package. As lazy as I could, I copy-pasted some files from another similar package. Everything was all smooth sailing until I ran the tests. Boom!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;axios_retry_1.default is not a function&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Noob-to-TS me asked: &lt;em&gt;“OK, why is it calling &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt;?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;A quick Google search told me that when TypeScript transpiles the code to JavaScript, a default export assigns the exported variable to the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; property of &lt;code class=&quot;language-text&quot;&gt;module.exports&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; Foo
&lt;span class=&quot;token comment&quot;&gt;// becomes&lt;/span&gt;
exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;default &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Therefore, when we do a default import like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; axiosRetry &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;axios-retry&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We actually expect the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; property to be callable. But &lt;code class=&quot;language-text&quot;&gt;axios-retry&lt;/code&gt; is written in plain JavaScript. It doesn’t export default.&lt;/p&gt;
&lt;p&gt;Well, that’s not a big problem. I imported modules written in CommonJS to TypeScript before. A star import would always work.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; axiosRetry &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;axios-retry&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But this time, I was thinking if there was a better way to do this. I hate extra meaningless keystrokes in my code. And that’s how I stumbled across &lt;code class=&quot;language-text&quot;&gt;esModuleInterop&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;what-is-esmoduleinterop&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#what-is-esmoduleinterop&quot; aria-label=&quot;what is esmoduleinterop permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;What is &lt;code class=&quot;language-text&quot;&gt;esModuleInterop&lt;/code&gt;?&lt;/h2&gt;
&lt;p&gt;It’s an option in &lt;code class=&quot;language-text&quot;&gt;tsconfig.json&lt;/code&gt; that allows importing CommonJS modules in compliance with the ES6 spec. But what does the spec says? It says: &lt;em&gt;a star import can only be a plain object, not callable&lt;/em&gt;. In this case, &lt;code class=&quot;language-text&quot;&gt;axiosRetry&lt;/code&gt; is not an object. It’s a function I actually want to call. So the star import here isn’t compliant with the spec.&lt;/p&gt;
&lt;p&gt;By setting &lt;code class=&quot;language-text&quot;&gt;esModuleInterop&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;, I can import &lt;code class=&quot;language-text&quot;&gt;axios-retry&lt;/code&gt; by the default import syntax and also get rid of the error I met earlier. Nice and clean!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; axiosRetry &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;axios-retry&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// spec compliant&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;axiosRetry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;axios&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// can call it too!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If I try calling &lt;code class=&quot;language-text&quot;&gt;axiosRetry&lt;/code&gt; when it’s star imported, I’ll get a compile-time error.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; axiosRetry &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;axios-retry&apos;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;axiosRetry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;axios&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// -&gt; This expression is not callable.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;optional-how-does-it-work&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#optional-how-does-it-work&quot; aria-label=&quot;optional how does it work permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;(Optional) How does it work?&lt;/h2&gt;
&lt;p&gt;When enabling &lt;code class=&quot;language-text&quot;&gt;esModuleInterop&lt;/code&gt;, modules are not imported directly but instead through a helper function &lt;code class=&quot;language-text&quot;&gt;__importDefault&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; axios_retry_1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__importDefault&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;axios-retry&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;__importDefault&lt;/code&gt; function looks like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; __importDefault &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__importDefault&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;mod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mod &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; mod&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__esModule&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; mod &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; mod &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see, if the imported module is not an ES6 module (checked via the &lt;code class=&quot;language-text&quot;&gt;__esModule&lt;/code&gt; property), this function assigns the module to the &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; property and returns it. Otherwise, it returns an untouched module.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Adaptive bitrate streaming]]></title><description><![CDATA[What is adaptive bitrate streaming? How does it work? And what benefits does it offer?]]></description><link>https://duckwho.codes/posts/adaptive-bitrate-streaming/</link><guid isPermaLink="false">https://duckwho.codes/posts/adaptive-bitrate-streaming/</guid><pubDate>Sun, 07 Mar 2021 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;If you watch a video on the Internet right now, chances are it’s being delivered to you by a technique called &lt;em&gt;adaptive bitrate streaming&lt;/em&gt;. Adaptive bitrate streaming helps you experience uninterrupted playback, even on an old/low-performance device, or on a cellular network. No longer staring at the spinning screen. No longer having to download the video to watch offline. It’s just smooth!&lt;/p&gt;
&lt;p&gt;Over the past few weeks, I’ve been working on a project that requires some understanding of this technique. And here are some of my findings. Let’s get into it!&lt;/p&gt;
&lt;h2 id=&quot;what-is-adaptive-bitrate-streaming&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#what-is-adaptive-bitrate-streaming&quot; aria-label=&quot;what is adaptive bitrate streaming permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;What is adaptive bitrate streaming?&lt;/h2&gt;
&lt;p&gt;Adaptive bitrate streaming is a technique used in streaming multimedia. It works by detecting a user’s available resources, especially network bandwidth, to adjust the quality of the stream in real-time so that the user experience as smooth playback as possible.&lt;/p&gt;
&lt;p&gt;The easiest example is watching a YouTube video. Have you ever noticed when you start watching a video, the quality is usually 480p, and after a few seconds it switches to 720p or 1080p, then if you go too far from your wifi router, it switches back to 480p so you can keep watching without being interrupted? That’s adaptive bitrate streaming I’m talking about.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 407px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/cda48dcaf7127860f02b1bf5b068fee4/0ff56/youtube.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 117.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEk0lEQVQ4y01U+1MaZxTd/8QZ2TcLgo+adCYVeVZ5KTZTHSedpk1ihEQBH4hgFNGViiiIqGwQAVFAUVEkTWsbTdC0ZtS2M+1Mf+gf07vYOD1zZ2d3ds8957vn+xa5OC1dnu1fne1/KH//9uTt8Q8np2/OOkxf0DQll8vvfXZPIBDgOI4R+C0Igqiqqprx+5Hjo62rcv76fen6olw+Ke/lC6Wj1yZTB0mSdXV1EmmNkKFFIkYMqIHiIZFIaJqOrEaR0l7mslz47RfQf5XP5l7GUrv7Rwa9EUUx+JYRCSUMJaYpmhEyIoYRVSAWkySxGIkgrw92r8rFP38tXZ5ubybiUS6RSm1rNJ+DskqpMhiN8sZ6ES4gaUoopIWMUMjwLcB5MBxGSsXih3eFvy4Or9/lEmtLK1wym93T6XSoABOLxEBgSJwmcIom6f+TSSIE5GKxdPbm4Pfzg/fH6XhsmVvb2tkvanVamItKpTa0tSvu3pEQOEERMMIKWXijHIosITs7+WKh8Kp4lMvmliLccjSRzuy1tGoFArTmZjwgRVEE6MPKhTApChbPk5fCSC67s7WZOT87/+nHEy6amF9Y5mLxFm0rhmEajcbY3qa40yjBMPIjE/rADQTHkw8OjxOJ1D9//3F1cbEW38hkCpvZvE5vQDGsIiwm4HOK/E9WSFcWT0HwwcUQUjz8mePWwXw8ucXF06nN3YPSsbHNhOE4KOv1eklNDQQDHOojv0LGZ+f9SCqZCwaXuJfpWCKX3tqLp7KZnT2DsQ3DcNgkJIkDE+ySPAjeNQBcEzj7HYv4/cGAPxhbyyTT+7H13Nx8OJ5Mgm2CIFtbtQ2fNEAqkBFFkSTYp0iCwAgSbOHeGQ8SjSY2NnbWU9tcLOObC3in3YlUTKfXC1BUKpVCMEAAwyTFK8MVBzLvGveyHiS5kd/MFpLp/MJi1Dlm9c2Obmyl+Gnj/LRBGRxSPI+4KZ5MQBTo5LQHWYtvrqzG54OhF+PDY+PWKdbJxVfVGjUcprq6WsiYqABaAIEvHMUr5AnvOBIMRefmwk5nv8PxLTszPsWOh5fnmxUyeK9UKmtrpSiG8m6Bi8PZxIAJjeBpzDOGDAz2ORz9ZnOnw9Hrcg+6XLZAgJXLm6qrq6VSiRBSITDyxvatBRwFjL5wIn3WhxbLlz09Jsuz7lG3lfVNhpdDSpVCIKiWyWQNDQ1AgHAoftx8E4JfMe9/2DmA2OyPR5z9vebuXnOXZ9K1EAqucFGVWgMS0tpakqLA/+0/BKsA+kINOmyI1fa43/oEri63fcbH+gOByEq0VauDnJQqVX19PQU7imFoOB38FqXBP4pVo5igx/wIcbmHx8acLMvO+v1zgQV/YGF62usYGbQP2h3OUduA3Wq3Dg3Z3QCPd8jp6uzq0Lfd/aan0+qwIE+f9potz5/32a22ISi4efCg+9GjrycmJsyWZxvptG14IOrzRZyjvoXFySl2xDls6mjusz152PMV0tKi0+qNBqPJyFeHVmeQyZqam2XwJ6qvb9BqtXKFor3jvt7Yfr+zy9Bm0rSoGz8VK9VNzcqmfwFSpOpeFrMRwgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/cda48dcaf7127860f02b1bf5b068fee4/8ac56/youtube.webp 240w,
/static/cda48dcaf7127860f02b1bf5b068fee4/c9427/youtube.webp 407w&quot;
              sizes=&quot;(max-width: 407px) 100vw, 407px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/cda48dcaf7127860f02b1bf5b068fee4/8ff5a/youtube.png 240w,
/static/cda48dcaf7127860f02b1bf5b068fee4/0ff56/youtube.png 407w&quot;
            sizes=&quot;(max-width: 407px) 100vw, 407px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/cda48dcaf7127860f02b1bf5b068fee4/0ff56/youtube.png&quot;
            alt=&quot;YouTube&quot;
            title=&quot;YouTube&quot;
            loading=&quot;lazy&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;how-does-it-work&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#how-does-it-work&quot; aria-label=&quot;how does it work permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How does it work?&lt;/h2&gt;
&lt;p&gt;For this little magic to work out, we need some processing at both the server and the client.&lt;/p&gt;
&lt;p&gt;When a media file is uploaded, it is encoded into multiple versions of itself at different bit rates (for videos, usually at different resolutions too). These versions then get chunked into small segments. The size of these segments depends on the implementations but is typically between 2 and 10 seconds.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ec02208f5dd9590b1f5eb6f80bf238be/e2310/how-it-works-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 67.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVQoz5WS2wqDMBBE/f+vDOiLGoxoveRme8hSkZJInQdZ1pmdvaR6l3Ech3PuldB1nTFGa933vfdeJ1Q3YkholFLrumYJ1Y0tmnmescVfMoIzLopDCP6LGONfziGBwFpLsCxL27b7vufFNDaOo9T2FyBGyXqaptm2LS/mN3uDx2AMaRMIyOOMJ3lq5cXwIFEbEiUIEJAchoE8haZpkoVlxNKk7BA2PARMwZc948+pim3/nOc8hizseqoHd5aekWEr+3/8SDhEXdePXxhgcnnMtJAlfAAMUv4JQmp5jQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/ec02208f5dd9590b1f5eb6f80bf238be/8ac56/how-it-works-1.webp 240w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/d3be9/how-it-works-1.webp 480w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/e46b2/how-it-works-1.webp 960w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/61c9b/how-it-works-1.webp 968w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/ec02208f5dd9590b1f5eb6f80bf238be/8ff5a/how-it-works-1.png 240w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/e85cb/how-it-works-1.png 480w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/d9199/how-it-works-1.png 960w,
/static/ec02208f5dd9590b1f5eb6f80bf238be/e2310/how-it-works-1.png 968w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/ec02208f5dd9590b1f5eb6f80bf238be/d9199/how-it-works-1.png&quot;
            alt=&quot;How it works 1&quot;
            title=&quot;How it works 1&quot;
            loading=&quot;lazy&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;When a user plays a video, the player client requests the server and receives a manifest file, which tells the player client how many segments this video has and where to find them. The segments are served over HTTP.&lt;/p&gt;
&lt;p&gt;Now the player client runs an algorithm to analyze the device resource metrics, including network speed, network bandwidth, and CPU capacity. It then chooses the segments with the suitable quality to start playing, while continues to run the algorithm in real-time and makes changes adaptively to the available resources.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 827px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/19468cc961e63a30a89ecc12d8a46928/4e6ec/how-it-works-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 87.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQ4y5WTyXKDMBBE+f/vyim35Aq+QJl9321QklcMllTYcdldZVnq0WhaPcLJsiyO46qqhmH4fQFfvfpslcydpmnKsuz7fpome9PPDYbZxu/m8lHMsnSUUuu6HvY9QTeMaVXvyfwhmLKXG67Xa9u2yKnruiiKcRxhdJSdFNtl84NirSwsyzLPsxx0CAljktl6L4+CeHnvohxhkimCmNkCNck8n89hGDLXPGWwFsYko0TdQfynsk2ypDuEmHDQv7KlWwcGF6MoStMURdj52DAgbh1EoRwvUCShvVVQ9p0J06Q8zyll8yToVu3J2vpXoN0+3lneGTE92ozsWTeYyqKTBe1xXTdJkiAIPM9DM0/tdDr5vq/vBcNokrUrHCnzZYN+bWInxemTGNF1HfWeterBV9F12Qap/16yGCb66dHbyVyB/eLiH7fcIEFbpp7MAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/19468cc961e63a30a89ecc12d8a46928/8ac56/how-it-works-2.webp 240w,
/static/19468cc961e63a30a89ecc12d8a46928/d3be9/how-it-works-2.webp 480w,
/static/19468cc961e63a30a89ecc12d8a46928/97d4f/how-it-works-2.webp 827w&quot;
              sizes=&quot;(max-width: 827px) 100vw, 827px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/19468cc961e63a30a89ecc12d8a46928/8ff5a/how-it-works-2.png 240w,
/static/19468cc961e63a30a89ecc12d8a46928/e85cb/how-it-works-2.png 480w,
/static/19468cc961e63a30a89ecc12d8a46928/4e6ec/how-it-works-2.png 827w&quot;
            sizes=&quot;(max-width: 827px) 100vw, 827px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/19468cc961e63a30a89ecc12d8a46928/4e6ec/how-it-works-2.png&quot;
            alt=&quot;How it works 2&quot;
            title=&quot;How it works 2&quot;
            loading=&quot;lazy&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The result is we have a very self-aware guy who can analyze stuff and pick the right work to do, all to give us — the end-users — the best experience possible.&lt;/p&gt;
&lt;h2 id=&quot;pros-and-cons&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#pros-and-cons&quot; aria-label=&quot;pros and cons permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Pros and cons&lt;/h2&gt;
&lt;p&gt;Compared to traditional multimedia streaming, back when the user has to download the media stream in the original quality and struggles when network speed is limited, adaptive bitrate streaming brings a lot of advantages, both for users and developers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Smooth playback in various network conditions.&lt;/li&gt;
&lt;li&gt;Serving over HTTP, widely compatible and secured.&lt;/li&gt;
&lt;li&gt;Can make use of our CDNs to cache media segments. This is a huge deal.&lt;/li&gt;
&lt;li&gt;Less development cost to develop and maintain servers that use other streaming protocols like &lt;a href=&quot;https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RTSP&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The seemingly only con when using adaptive bitrate streaming is more storage cost, as we have to store multiple copies of a media file source. However, with all the good stuff we’re getting from it, adaptive bitrate streaming is a great technique that benefits everyone.&lt;/p&gt;
&lt;h2 id=&quot;whats-more&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#whats-more&quot; aria-label=&quot;whats more permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;What’s more?&lt;/h2&gt;
&lt;p&gt;There are numerous well-known implementations like &lt;a href=&quot;https://en.wikipedia.org/wiki/Dynamic_Adaptive_Streaming_over_HTTP&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;MPEG-DASH&lt;/a&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/HTTP_Live_Streaming&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;HLS&lt;/a&gt;, which you can read more about. There is &lt;a href=&quot;https://youtube-eng.googleblog.com/2018/04/making-high-quality-video-efficient.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;this&lt;/a&gt; blog post by YouTube on how they’re doing adaptive video streaming. You can also take a look at &lt;a href=&quot;https://en.wikipedia.org/wiki/Real-time_Transport_Protocol&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RTP&lt;/a&gt;, which is a protocol that’s used in multimedia streaming. Have fun reading!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[10 bài viết hay nhất mình đọc trong năm 2020]]></title><description><![CDATA[Đến hẹn lại lên, mình tổng hợp 10 bài viết hay nhất mà mình đã đọc trong năm 2020.]]></description><link>https://duckwho.codes/posts/10-bai-viet-hay-nhat-minh-doc-trong-nam-2020/</link><guid isPermaLink="false">https://duckwho.codes/posts/10-bai-viet-hay-nhat-minh-doc-trong-nam-2020/</guid><pubDate>Sat, 06 Feb 2021 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Đến hẹn lại lên, mình tổng hợp 10 bài viết hay nhất mà mình đã đọc trong năm 2020.&lt;/p&gt;
&lt;p&gt;(Lười quá :v Sang năm 2021 được một tháng rồi mới viết bài)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. &lt;a href=&quot;https://medium.com/@bayareabelletrist/how-i-negotiated-a-software-engineer-offer-in-silicon-valley-f11590f5c656&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;How I negotiated a $300,000 job offer in Silicon Valley&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;2020 là một năm điên rồ. Hãy xem lập trình viên này đã có được một offer điên rồ như thế nào.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. &lt;a href=&quot;https://viblo.asia/p/ky-an-toc-do-noi-oan-cua-chang-redis-RQqKLQJzZ7z&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Kỳ án tốc độ: Nỗi oan của chàng Redis&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Redis là một database rất nhanh, thế nhưng mà…&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. &lt;a href=&quot;http://scarlet.spiderum.com/bai-dang/Lam-the-nao-de-toi-uu-hoa-viec-phat-trien-ban-than-lva&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Làm thế nào để tối ưu hoá việc phát triển bản thân?&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;2020 là năm mình bắt đầu biết đến Spiderum, và cộng đồng này không làm mình thất vọng với những bài viết chất lượng như này.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. &lt;a href=&quot;https://pmihaylov.com/sorting-algorithms/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;What you don’t know about sorting algorithms&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Các thuật toán sắp xếp có những điều gì thú vị mà ít được nhắc đến?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. &lt;a href=&quot;https://pmihaylov.com/achieving-a-meaningful-goal/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;The process of achieving a meaningful goal&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Làm thế nào để đạt được mục tiêu? Bài viết với một góc nhìn rất thú vị của tác giả.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6. &lt;a href=&quot;https://viblo.asia/p/thuat-toan-xep-hang-bai-viet-dang-hot-thinh-hanh-nhu-reddit-va-hacker-news-hoat-dong-the-nao-gAm5y8xXldb&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Thuật toán xếp hạng bài viết đang hot, thịnh hành như Reddit và Hacker News hoạt động thế nào?&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Đã bao giờ bạn thắc mắc điều này chưa? Hãy đọc bài viết để biết câu trả lời.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7. &lt;a href=&quot;https://dev.to/pmihaylov/how-to-study-effectively-as-a-full-time-developer-emo&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;How to study effectively as a full-time developer&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Là một lập trình viên full-time, làm sao để bạn có thể học công nghệ/kiến thức mới với vốn thời gian ít ỏi của mình?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;8. &lt;a href=&quot;https://spiderum.com/bai-dang/Machine-Learning-giai-thich-theo-ngon-ngu-binh-dan-Phan-1-kmx&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Machine Learning - giải thích theo ngôn ngữ bình dân (Phần 1)&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Đúng thật là rất bình dân, đọc phát hiểu liền :D (Dĩ nhiên là hiểu tổng quát thôi)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9. &lt;a href=&quot;https://collegeinfogeek.com/become-t-shaped-person/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;The T-Shaped Person: Building Deep Expertise AND a Wide Knowledge Base&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Chắc hẳn là bạn đã nghe tới cụm từ “T-shaped developer”. Thế còn “T-shaped person” thì sao?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10. &lt;a href=&quot;https://learn2code.dev/posts/10x-engineer-part-1/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Sếp nhớ trả lương em gấp 10 nha (phần 1)&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Tập hợp những bài học đáng giá trong ngành gõ phím kiếm cơm.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Conditional không cần if else hoặc switch trong JavaScript]]></title><description><![CDATA[Một bài note nhanh và ngắn chia sẻ về sự hay ho của JavaScript. Mới đây mình gặp một tình huống nho nhỏ như sau.]]></description><link>https://duckwho.codes/posts/conditional-khong-can-if-else-hoac-switch-trong-javascript/</link><guid isPermaLink="false">https://duckwho.codes/posts/conditional-khong-can-if-else-hoac-switch-trong-javascript/</guid><pubDate>Tue, 01 Sep 2020 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Một bài note nhanh và ngắn chia sẻ về sự hay ho của JavaScript. Mới đây mình gặp một tình huống nho nhỏ như sau.&lt;/p&gt;
&lt;p&gt;Có một entity &lt;code class=&quot;language-text&quot;&gt;User&lt;/code&gt; với 2 trường: &lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt;. Mỗi trường lần lượt có những giá trị sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;[&amp;#39;NO_ACCESS&amp;#39;, &amp;#39;PENDING_SUBSCRIBE&amp;#39;, &amp;#39;SUBSCRIBED&amp;#39;, &amp;#39;PENDING_CANCEL&amp;#39;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;[&amp;#39;NO_ACCESS&amp;#39;, &amp;#39;DELAYED&amp;#39;, &amp;#39;CLICK2REFRESH&amp;#39;, &amp;#39;REALTIME&amp;#39;]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nhiệm vụ của mình là viết một API để update 2 trường trên:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;PUT /users/:user_id&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;status&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;PENDING_SUBSCRIBE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REALTIME&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vì 2 trường này có mối liên hệ với nhau, nên sau khi vận dụng hết năng lực toán học cao cấp từ 12 năm đèn vở bonus vài năm tự đi chợ mua rau của mình, mình tính ra được có tất cả 16 trường hợp cần xử lý ở trong API trên. Không sợ kẻ thù đông, mình sắn ống tay ra trận. Sau đây là tường thuật diễn biến trận đấu.&lt;/p&gt;
&lt;h3 id=&quot;round-1-if-else&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#round-1-if-else&quot; aria-label=&quot;round 1 if else permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Round 1: &lt;code class=&quot;language-text&quot;&gt;if else&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Ban đầu, mình thử code ngay với kiểu &lt;code class=&quot;language-text&quot;&gt;if else&lt;/code&gt; truyền thống.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NO_ACCESS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NO_ACCESS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;DELAYED&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;CLICK2REFRESH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;REALTIME&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;PENDING_SUBSCRIBE&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NO_ACCESS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;DELAYED&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Và chẳng cần phải nói, đống code trên nhìn như shit vậy. Quá rối rắm và nếu không cẩn thận thì rất dễ để viết sai tên trường hoặc giá trị so sánh. Vì vậy, mình đã chuyển sang dùng vũ khí lợi hại hơn.&lt;/p&gt;
&lt;h3 id=&quot;round-2-switch-case&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#round-2-switch-case&quot; aria-label=&quot;round 2 switch case permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Round 2: &lt;code class=&quot;language-text&quot;&gt;switch case&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NO_ACCESS&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NO_ACCESS&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;DELAYED&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;CLICK2REFRESH&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;REALTIME&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;PENDING_SUBSCRIBE&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SUBSCRIBED&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;PENDING_CANCEL&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Tuy code đã nhìn gọn hơn, nhưng cơ bản nó vẫn không khác &lt;code class=&quot;language-text&quot;&gt;if else&lt;/code&gt; là mấy. Càng nhiều &lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; thì đoạn code sẽ càng dài và khó đọc. Đến lúc này, mình đành phải vận nội công, tận dụng tối đa tính dynamic của JavaScript, và kết quả là…&lt;/p&gt;
&lt;h3 id=&quot;round-3-object-mapping&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#round-3-object-mapping&quot; aria-label=&quot;round 3 object mapping permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Round 3: Object mapping&lt;/h3&gt;
&lt;p&gt;Sử dụng giá trị của 2 trường &lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt;, mình tạo ra một object như sau:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; handlerMapping &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;NO_ACCESS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function-variable function&quot;&gt;NO_ACCESS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token function-variable function&quot;&gt;DELAYED&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token function-variable function&quot;&gt;CLICK2REFRESH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token function-variable function&quot;&gt;REALTIME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;PENDING_SUBSCRIBE&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lúc này, việc gọi hàm xử lý trở nên dễ dàng hơn rất nhiều:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// get the handler function&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; handler &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; handlerMapping&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// execute the function&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Cách sử dụng object mapping làm giảm bớt những keyword lặp đi lặp lại của 2 cách trên, phù hợp với những trường hợp điều kiện check dài với mỗi trường có nhiều giá trị. Dù không phải là cái gì đó quá đột phá nhưng mình cảm thấy khá hay ho và đáng để chia sẻ. Cảm ơn các bạn đã đọc hết bài này. 🤗&lt;/p&gt;</content:encoded></item><item><title><![CDATA[10 terminal tools giúp bạn tăng hiệu suất làm việc]]></title><description><![CDATA[10 terminal tools giúp việc thao tác trên terminal trở nên ngầu lòi, nhanh chóng và hiệu quả.]]></description><link>https://duckwho.codes/posts/10-terminal-tools-giup-ban-tang-hieu-suat-lam-viec/</link><guid isPermaLink="false">https://duckwho.codes/posts/10-terminal-tools-giup-ban-tang-hieu-suat-lam-viec/</guid><pubDate>Sat, 02 May 2020 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Bạn có sử dụng terminal hàng ngày không? Bạn có thường xuyên cảm thấy gõ lệnh trên terminal thật chán và hay chuyển sang tìm các GUI apps để thay thế? Đó là vì bạn chưa tìm ra những tools thú vị giúp việc thao tác trên terminal trở nên ngầu lòi, nhanh chóng và hiệu quả hơn các GUI apps nhiều lần.&lt;/p&gt;
&lt;p&gt;Hôm nay, mình sẽ chia sẻ 10 terminal tools giúp tăng hiệu suất làm việc của bạn. List là ý kiến cá nhân của mình và không được sắp xếp theo thứ tự đặc biệt gì cả.&lt;/p&gt;
&lt;h2 id=&quot;1-zsh&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-zsh&quot; aria-label=&quot;1 zsh permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. zsh&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Z_shell&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;ZSH&lt;/a&gt; là một phiên bản mở rộng của Bourne Shell (sh), nôm na là cùng cha khác mẹ với Bash. Vì vậy ZSH có rất nhiều điểm chung với Bash và gần như không yêu cầu bạn phải làm quen lại từ đầu. Apple thậm chí đã dùng ZSH làm shell mặc định cho phiên bản MacOS mới nhất Catalina.&lt;/p&gt;
&lt;p&gt;Tính năng hay nhất của ZSH chính là khả năng mở rộng bằng plugins và themes. Có đủ loại plugins cho mọi yêu cầu khác nhau. Các bạn có thể thoải mái biến tùy biến terminal của mình với list &lt;a href=&quot;https://github.com/unixorn/awesome-zsh-plugins&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;awesome-zsh-plugins&lt;/a&gt; này (rất khuyên các bạn cài &lt;a href=&quot;https://github.com/ohmyzsh/ohmyzsh&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;oh-my-zsh&lt;/a&gt; đầu tiên).&lt;/p&gt;
&lt;h2 id=&quot;2-fast-syntax-highlighting-và-zsh-autosuggestions&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-fast-syntax-highlighting-v%C3%A0-zsh-autosuggestions&quot; aria-label=&quot;2 fast syntax highlighting và zsh autosuggestions permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. fast-syntax-highlighting và zsh-autosuggestions&lt;/h2&gt;
&lt;p&gt;Nếu đã sử dụng ZSH rồi thì không có lí do gì mà bạn không nên dùng thêm 2 plugins này.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/zdharma/fast-syntax-highlighting&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;fast-syntax-highlighting&lt;/a&gt; cung cấp syntax highlighting và format cho các câu lệnh bạn gõ trên terminal, cũng như cho output của một số câu lệnh thông dụng. Nếu bạn gõ sai, chẳng hạn &lt;code class=&quot;language-text&quot;&gt;git&lt;/code&gt; thành &lt;code class=&quot;language-text&quot;&gt;gjt&lt;/code&gt; thì fast-syntax-highlighting sẽ bôi đỏ &lt;code class=&quot;language-text&quot;&gt;gjt&lt;/code&gt; để cho bạn biết.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/zdharma/fast-syntax-highlighting/master/images/highlight-much.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/zsh-users/zsh-autosuggestions&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;zsh-autosuggestions&lt;/a&gt; gợi ý câu lệnh dựa vào lịch sử command line hoặc tab completion và hiển thị mờ mờ tại con trỏ ngay khi bạn đang gõ. Với tính năng xịn xò này bạn có thể gõ terminal với tốc độ thần gió và ít phải nhớ câu lệnh hơn.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://asciinema.org/a/37390&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://asciinema.org/a/37390.png&quot; width=&quot;400&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ngoài ra khi sử dụng một chương trình nào đó thường xuyên, bạn cũng nên Google từ khóa “tên chương trình + zsh auto completion” để tìm và cài thêm plugins. Mỗi khi gõ chỉ cần Tab là hiện ra suggestions rất tiện.&lt;/p&gt;
&lt;h2 id=&quot;3-fzf&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-fzf&quot; aria-label=&quot;3 fzf permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. fzf&lt;/h2&gt;
&lt;p&gt;Nếu cho mình chọn chỉ một trong số 10 terminal tools mình gợi ý cho các bạn hôm nay, thì mình sẽ chọn &lt;a href=&quot;https://github.com/junegunn/fzf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;fzf&lt;/a&gt;. Nếu như zsh-autosuggestions chỉ giúp bạn ít phải nhớ câu lệnh hơn, thì fzf sẽ giúp bạn không còn phải nhớ chúng nữa.&lt;/p&gt;
&lt;p&gt;fzf đọc lịch sử gõ terminal của bạn và cung cấp một giao diện fuzzy search cực kì xịn. Bạn chỉ cần gõ 2-3 kí tự của câu lệnh cần tìm là gần như đã có thể thấy nó xuất hiện ở kết quả search rồi. Từ tốc độ thần gió, bạn đã có thể gõ terminal với tốc độ người yêu lật mặt =))&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://miro.medium.com/max/3284/0*w9bAo-aW3ruV15oz.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;fzf chạy được trên hầu hết các shell (bao gồm cả ZSH và Bash), thậm chí có cả plugin cho Vim và nhiều chương trình khác.&lt;/p&gt;
&lt;h2 id=&quot;4-bat&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-bat&quot; aria-label=&quot;4 bat permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. bat&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;cat&lt;/code&gt; chắc chắn là một trong những câu lệnh bạn dùng nhiều nhất trong terminal. Vậy tại sao lại không gắn thêm cánh cho mèo? &lt;a href=&quot;https://github.com/sharkdp/bat&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;bat&lt;/a&gt; cung cấp syntax highlighting cho rất nhiều ngôn ngữ lập trình và ngôn ngữ markup, thậm chí đánh dấu cả dòng có sự thay đổi dựa vào git. Nhìn output của bat chắc chắn sướng mắt hơn nhiều phải không?&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://camo.githubusercontent.com/67e44f4a68150325f74b3a46820b7473ff7b91a6/68747470733a2f2f692e696d6775722e636f6d2f326c53573452452e706e67&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;5-lazygit&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-lazygit&quot; aria-label=&quot;5 lazygit permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. lazygit&lt;/h2&gt;
&lt;p&gt;Như cái tên, &lt;a href=&quot;https://github.com/jesseduffield/lazygit&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;lazygit&lt;/a&gt; dành cho những con người lười dùng câu lệnh git. Giao diện của lazygit khá đầy đủ, bạn có thể xem các file thay đổi, commit, chuyển nhánh… tất tần tật trên đây.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://opensource.com/sites/default/files/uploads/lazygit_1.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;6-diff-so-fancy&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-diff-so-fancy&quot; aria-label=&quot;6 diff so fancy permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. diff-so-fancy&lt;/h2&gt;
&lt;p&gt;Nếu sử dụng lazygit thường xuyên thì bạn sẽ nhìn qua nhìn lại output của &lt;code class=&quot;language-text&quot;&gt;git diff&lt;/code&gt; khá nhiều. Có điều là diff mặc định của git nhìn khá chán, khó đọc. &lt;a href=&quot;https://github.com/so-fancy/diff-so-fancy&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;diff-so-fancy&lt;/a&gt; biến output này thành gần giống như của GitHub hay VSCode, nhìn dễ hơn nhiều. Bạn có thể custom lại config màu theo ý thích. diff-so-fancy áp dụng output này cho tất cả câu lệnh &lt;code class=&quot;language-text&quot;&gt;git diff&lt;/code&gt; chứ không chỉ riêng khi chạy lazygit.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/3429760/32387617-44c873da-c082-11e7-829c-6160b853adcb.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;7-tmux&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7-tmux&quot; aria-label=&quot;7 tmux permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7. tmux&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/tmux/tmux&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;tmux&lt;/a&gt; là một chương trình giúp bạn phân chia màn hình terminal ra nhiều panes và windows, và lưu layout đó dưới một session. Bạn có thể tạo nhiều sessions và chuyển qua lại giữa chúng mà không mất layout của session cũ. tmux cũng hỗ trợ plugins và themes rất đa dạng, các bạn có thể tham khảo ở list &lt;a href=&quot;https://github.com/rothgar/awesome-tmux&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;awesome-tmux&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hamvocke.com/assets/img/uploads/tmux.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;8-tmuxp&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#8-tmuxp&quot; aria-label=&quot;8 tmuxp permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8. tmuxp&lt;/h2&gt;
&lt;p&gt;tmux rất tuyệt, cho đến khi bạn phải restart máy tính. Với &lt;a href=&quot;https://github.com/tmux-python/tmuxp&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;tmuxp&lt;/a&gt;, bạn có thể lưu layout của mình lại dưới dạng file YAML hoặc JSON. Mọi thứ lại tuyệt trở lại, trừ khi bạn bị virus ăn mất file config layout mà thôi 😁&lt;/p&gt;
&lt;h2 id=&quot;9-nnn&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#9-nnn&quot; aria-label=&quot;9 nnn permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9. nnn&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jarun/nnn&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;nnn&lt;/a&gt; là một trình quản lý file trên terminal, vì thế mà tốc độ duyệt files và thư mục rất nhanh. Bạn vẫn có thể preview ảnh và mở files bằng GUI apps. Ngoài ra, nnn còn có những tính năng khác như batch rename, mở file text sang một pane tmux bên cạnh, type-to-nav, v.v.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://camo.githubusercontent.com/d7abd98b23e90b9b4c295e2b15b7150b53cdd5a0/68747470733a2f2f692e696d6775722e636f6d2f4d5057706d6f732e706e67&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;10-tldr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#10-tldr&quot; aria-label=&quot;10 tldr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10. tldr&lt;/h2&gt;
&lt;p&gt;TL;DR (viết tắt của “Too Long. Didn’t Read”) là khi một bài viết dài quá, bạn lười đọc nên tác giả để một phần đầu hoặc cuối bài tóm tắt lại những ý chính. Tương tự, các terminal tools đôi khi có quá nhiều commands, options mà hầu hết đều không dùng đến. &lt;a href=&quot;https://github.com/tldr-pages/tldr&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;tldr&lt;/a&gt; là một chương trình tóm tắt và trình bày lại ngắn gọn vài câu lệnh hay sử dụng của một chương trình nào đó. Ví dụ bạn muốn xem qua cách sử dụng &lt;code class=&quot;language-text&quot;&gt;tar&lt;/code&gt; thì chỉ cần gõ &lt;code class=&quot;language-text&quot;&gt;tldr tar&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://tldr.sh/assets/img/screenshot.png&quot;&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Khi require một file n lần, thì đoạn code bên trong file đó chạy bao nhiêu lần?]]></title><description><![CDATA[Hôm nay cuối sprint, đang hoàn thành nốt cái coverage test cho đúng hạn thì mình gặp phải tình huống như thế này.]]></description><link>https://duckwho.codes/posts/khi-require-mot-file-n-lan-thi-doan-code-ben-trong-file-do-chay-bao-nhieu-lan/</link><guid isPermaLink="false">https://duckwho.codes/posts/khi-require-mot-file-n-lan-thi-doan-code-ben-trong-file-do-chay-bao-nhieu-lan/</guid><pubDate>Tue, 25 Feb 2020 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Hôm nay cuối sprint, đang hoàn thành nốt cái coverage test cho đúng hạn thì mình gặp phải tình huống như thế này.&lt;/p&gt;
&lt;h2 id=&quot;the-problem&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#the-problem&quot; aria-label=&quot;the problem permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;The problem&lt;/h2&gt;
&lt;p&gt;Mình có file &lt;code class=&quot;language-text&quot;&gt;axon.js&lt;/code&gt; export một hàm &lt;code class=&quot;language-text&quot;&gt;connect()&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; axon &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;axon&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sock &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; axon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;push&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;connect&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;resolve&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    sock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Hàm này được dùng ở file &lt;code class=&quot;language-text&quot;&gt;index.js&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; axon &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./axon&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;doSomething&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; connected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; axon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;real_address&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;connected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// do something else&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Để test case khi chạy không phải connect ra ngoài thì mình sẽ mock. Ý tưởng lúc đầu là mock thằng &lt;code class=&quot;language-text&quot;&gt;axon.socket()&lt;/code&gt;. Đoạn test case lúc đó của mình nhìn như sau:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;doSomething() succeeds&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    axon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;socket &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; jest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;mockImplementationOnce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token function-variable function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token function&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;success&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Chạy &lt;code class=&quot;language-text&quot;&gt;jest --coverage&lt;/code&gt; lên thấy test case pass xanh lè, cover luôn được dòng &lt;code class=&quot;language-text&quot;&gt;resolve(true);&lt;/code&gt; trong &lt;code class=&quot;language-text&quot;&gt;axon.js&lt;/code&gt; ngon lành. Đang thắng, mình copy paste làm cái test case thứ hai cho trường hợp connect fail.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;doSomething() fails&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    axon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;socket &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; jest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;mockImplementationOnce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token function-variable function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token function&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;success&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ơ, &lt;strong&gt;“1 failed”&lt;/strong&gt;, Jest said. Sai làm sao được nhỉ? Mình đã &lt;code class=&quot;language-text&quot;&gt;mockReset()&lt;/code&gt; trong &lt;code class=&quot;language-text&quot;&gt;beforeEach()&lt;/code&gt; rồi, lại còn dùng &lt;code class=&quot;language-text&quot;&gt;mockImplementationOnce()&lt;/code&gt; nữa. Thử debug thì thấy &lt;code class=&quot;language-text&quot;&gt;connected&lt;/code&gt; là &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt; rõ ràng, test case pass bình thường. Nhưng cứ chạy &lt;code class=&quot;language-text&quot;&gt;jest --coverage&lt;/code&gt; thì không pass. Thử xóa &lt;code class=&quot;language-text&quot;&gt;node_modules&lt;/code&gt; rồi &lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt; lại vẫn vậy. Kì lạ!&lt;/p&gt;
&lt;p&gt;Sau một hồi loay hoay cầu cứu bác Gu gồ, cuối cùng bác phán cho một câu như này: &lt;strong&gt;&lt;em&gt;“Modules are cached after the first time they are loaded.”&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;introduction-to-how-require-in-nodejs-works&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#introduction-to-how-require-in-nodejs-works&quot; aria-label=&quot;introduction to how require in nodejs works permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Introduction to how &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; in Node.js works&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; là một built-in function của Node.js, nhận vào một biến string là path dẫn đến file cần require và trả về một object, một hàm hoặc bất kì cái gì khác mà file đó export ra. Vì cú pháp sử dụng đơn giản, lại xuất hiện ở mọi nơi trong project nên đôi khi chúng ta không quan tâm &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; hoạt động như thế nào.&lt;/p&gt;
&lt;p&gt;Khi được gọi, &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; sẽ thực thi lần lượt theo các bước sau:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Tìm absolute path của file đang được require, nếu không truyền file extension thì mặc định tìm với extension &lt;code class=&quot;language-text&quot;&gt;.js&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Xác định content type của file đó, ngoài &lt;code class=&quot;language-text&quot;&gt;.js&lt;/code&gt; thì Node.js có thể require cả file &lt;code class=&quot;language-text&quot;&gt;.json&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;.node&lt;/code&gt; nữa&lt;/li&gt;
&lt;li&gt;Kiểm tra xem file này đã được cache chưa, nếu rồi thì trả về kết quả luôn, nếu chưa thì đi tiếp bước 4&lt;/li&gt;
&lt;li&gt;Khởi tạo một private scope cho file, vì vậy nên 2 biến “global” trong 2 file JS khác nhau có thể đặt trùng tên được&lt;/li&gt;
&lt;li&gt;Load code vào bộ nhớ&lt;/li&gt;
&lt;li&gt;Cache lại file này&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Đến đây thì dễ dàng để nhận ra vấn đề rồi. File &lt;code class=&quot;language-text&quot;&gt;axon.js&lt;/code&gt; được require 2 lần khi chạy &lt;code class=&quot;language-text&quot;&gt;jest --coverage&lt;/code&gt;, nhưng khi debug riêng 1 test case thì nó chỉ được require 1 lần. Hàm &lt;code class=&quot;language-text&quot;&gt;axon.socket()&lt;/code&gt; chỉ thực thi một lần và được cache lại. Chính vì vậy nên test case fail mới fail :)) Nếu mình đổi thứ tự cho test case succeed xuống dưới thì nó mới là thằng bị fail.&lt;/p&gt;
&lt;p&gt;Nếu vậy thì làm sao giờ? Thử tách test case ra 2 hàm &lt;code class=&quot;language-text&quot;&gt;describe()&lt;/code&gt; xem sao? Vẫn fail. Thử tách hẳn ra 2 file, mỗi file 1 test case. Pass! Nhưng mà như này tù quá, không thể cứ mỗi test case để 1 file được.&lt;/p&gt;
&lt;h2 id=&quot;jestdomock-to-the-rescue&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jestdomock-to-the-rescue&quot; aria-label=&quot;jestdomock to the rescue permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;jest.doMock()&lt;/code&gt; to the rescue!&lt;/h2&gt;
&lt;p&gt;Hàm này sẽ mock cả package &lt;code class=&quot;language-text&quot;&gt;axon&lt;/code&gt;, kết hợp với &lt;code class=&quot;language-text&quot;&gt;jest.resetModules()&lt;/code&gt; thì mỗi lần gặp &lt;code class=&quot;language-text&quot;&gt;require(&amp;#39;axon&amp;#39;)&lt;/code&gt; trong code Jest sẽ dùng mock implementation của mình chứ không phải đọc từ file, vì vậy sẽ không còn cache trong require nữa.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token function&quot;&gt;beforeEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    jest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;resetModules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;doSomething() succeeds&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    jest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doMock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;axon&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token function-variable function&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token function-variable function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; connected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;connected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;doSomething() fails&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    jest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doMock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;axon&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token function-variable function&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token function-variable function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; connected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;connected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Kết quả 2 test case đều pass ngon lành, coverage 100% và mình có thể yên tâm đi về viết bài blog này. 🎉&lt;/p&gt;
&lt;p&gt;Hi vọng bài viết có ích!&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Tham khảo từ:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://nodejs.org/dist/latest-v12.x/docs/api/modules.html#modules_require_id&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Modules | Node.js v12.16.1 Documentation&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://www.freecodecamp.org/news/requiring-modules-in-node-js-everything-you-need-to-know-e7fbd119be8/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Requiring modules in Node.js: Everything you need to know&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://stackoverflow.com/a/30038787/8943850&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;javascript - Requiring same module in multiple files - Stack Overflow&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[10 bài viết hay nhất mình đọc trong năm 2019]]></title><description><![CDATA[Sắp hết năm 2019, mình tổng hợp lại 10 bài viết hay nhất mà mình đọc được trong năm nay.]]></description><link>https://duckwho.codes/posts/10-bai-viet-hay-nhat-minh-doc-trong-nam-2019/</link><guid isPermaLink="false">https://duckwho.codes/posts/10-bai-viet-hay-nhat-minh-doc-trong-nam-2019/</guid><pubDate>Tue, 24 Dec 2019 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Sắp hết năm 2019, mình tổng hợp lại 10 bài viết hay nhất mà mình đọc được trong năm nay.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. &lt;a href=&quot;https://dev.to/santypk4/bulletproof-node-js-project-architecture-4epf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Bulletproof Node.js project architecture&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cấu trúc project Node.js server được giới thiệu trong bài viết này rất hay và scalable, áp dụng nhiều best practice, cho phép nhiều người cùng phát triển ở một repo mà không dễ gây conflict.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. &lt;a href=&quot;https://kipalog.com/posts/Nghe-thuat-xu-ly-background-job&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Nghệ thuật xử lý background job&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Nếu bạn từng hoặc đang phải làm việc với background job thì bài viết này sẽ nâng tầm của bạn lên kha khá với những nghệ thuật được chia sẻ.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. &lt;a href=&quot;https://devonblog.com/containers/affordable-kubernetes-cluster&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Affordable Kubernetes Cluster&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Muốn có một Kubernetes Cluster với 3 nodes và 1 free load balancer? Bạn chỉ mất khoảng 5 USD/tháng với set up này.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. &lt;a href=&quot;https://dev.to/khaosdoctor/node-js-under-the-hood-3-deep-dive-into-the-event-loop-135d&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Node.js Under The Hood #3 - Deep Dive Into the Event Loop&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Một trong những bài viết thuộc series chia sẻ về kiến trúc của Node.js rất chi tiết.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. &lt;a href=&quot;https://quan-cam.com/posts/cache-stampede-hien-tuong-chat-dong-cache&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Cache stampede — Hiện tượng chất đống cache&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Bác &lt;a href=&quot;https://quan-cam.com&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Quần Cam&lt;/a&gt; giải thích về hiện tượng chất đống cache và cách xử lý chúng.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6. &lt;a href=&quot;https://viblo.asia/p/thiet-ke-he-thong-url-shortening-giong-bitly-chiu-tai-6-ty-click-1-thang-Ljy5VY1zlra&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Thiết kế hệ thống URL Shortening giống Bit.ly chịu tải 6 tỷ click 1 tháng&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mình rất thích những bài viết về thiết kế hệ thống từ A-Z như này.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7. &lt;a href=&quot;https://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Best Practices for Designing a Pragmatic RESTful API&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Những best practice được trình bày giúp bạn thiết kế RESTful API chất lượng hơn.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;8. &lt;a href=&quot;https://topdev.vn/blog/speed-up-microservices-2-tan-dung-trinh-duyet-va-cache&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Speed up Microservices 2: Tận dụng trình duyệt và cache&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Một bài viết nữa thuộc thể loại thiết kế hệ thống để giải quyết một vấn đề nào đó. Series gồm 3 phần này cũng rất hay.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9. &lt;a href=&quot;https://toidicodedao.com/2015/12/24/nhung-manh-khoe-khong-bao-gio-tiet-lo-cua-cac-lap-trinh-vien-vi-dai/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Những mánh khóe “không bao giờ tiết lộ” của các lập trình viên vĩ đại&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Một màn tiết lộ những mánh khóe không bao giờ tiết lộ của các ông não có sỏi đến từ vị trí của anh &lt;a href=&quot;https://toidicodedao.com&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Tôi Đi Code Dạo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10. &lt;a href=&quot;https://dev.to/heroku/postgres-is-underrated-it-handles-more-than-you-think-4ff3&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Postgres Is Underrated — It Handles More than You Think&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Giới thiệu đến những chức năng hay ho khác của PostgreSQL mà ít người biết tới.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Review sách The Little Go Book]]></title><description><![CDATA[Một chút review về cuốn sách dành cho Go beginner như mình.]]></description><link>https://duckwho.codes/posts/review-sach-the-little-go-book/</link><guid isPermaLink="false">https://duckwho.codes/posts/review-sach-the-little-go-book/</guid><pubDate>Mon, 23 Dec 2019 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Một chút review về cuốn sách dành cho Go beginner như mình.&lt;/p&gt;
&lt;p&gt;Review (một số chỉ là note) được viết theo thứ tự mình đọc sách, và chẳng có sự kết dính nào cả giữa các phần với nhau =))&lt;/p&gt;
&lt;p&gt;Cá nhân mình thấy cuốn sách rất phù hợp để làm quen với các khái niệm của Go và tác giả cũng định hướng mindset luôn để mình có thể nhận ra sự khác biệt và tự tìm hiểu sâu hơn.&lt;/p&gt;
&lt;p&gt;Một số thông tin về cuốn sách:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tác giả: Karl Seguin&lt;/li&gt;
&lt;li&gt;Số trang: 83&lt;/li&gt;
&lt;li&gt;Link đọc: &lt;a href=&quot;https://www.openmymind.net/assets/go/go.pdf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.openmymind.net/assets/go/go.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1&quot; aria-label=&quot;1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;“Go is a compiled, statically typed language with a C-like syntax and garbage collection.”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Từ câu mở đầu Chương 1 trên có thể suy ra vài thứ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Go là ngôn ngữ biên dịch, bạn cần 1 compiler và sẽ phải build để run code&lt;/li&gt;
&lt;li&gt;Go là ngôn ngữ có kiểu của biến được xác định ở compile-time (ngược lại với JavaScript)&lt;/li&gt;
&lt;li&gt;Go có syntax kiểu giống C (chứ không phải như Assembly)&lt;/li&gt;
&lt;li&gt;Go có garbage collection (ơn giời :v )&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Chương 1 giới thiệu ngắn gọn một số đặc điểm của Go và một số điểm khác biệt về import, khai báo biến. Đọc rất trôi và không bị choáng ngợp như những bài tutorials liệt kê tất cả các kiểu dữ liệu hoặc những bài lặp lại những cấu trúc if else, for loop mà ngôn ngữ nào cũng có.&lt;/p&gt;
&lt;h2 id=&quot;2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2&quot; aria-label=&quot;2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2&lt;/h2&gt;
&lt;p&gt;Chương 2 giới thiệu về structure trong Go. Go không phải là ngôn ngữ OOP, không có inheritance, polymorphism hay overloading. Chỉ cần structure thôi là đủ. Structure trong Go cũng hỗ trợ method và composition nên thực ra cũng khá dễ làm quen.&lt;/p&gt;
&lt;p&gt;Một điểm giống JavaScript là các fields trong structure có thể có bất kì kiểu dữ liệu nào, có thể là một structure khác. Nên có thể tha hồ “chấm” dạo N lần, như này: &lt;code class=&quot;language-text&quot;&gt;I.Dont.Want.To.Work&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;À nữa, Go có pointer, và mặc định là pass-by-value nên bạn sẽ rơi vào cuộc chiến &lt;em&gt;“nên dùng value hay pointer đây”&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&quot;3&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3&quot; aria-label=&quot;3 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3&lt;/h2&gt;
&lt;p&gt;Array trong Go giống hệt như trong C, có độ dài fix cứng khi khai báo và không thể tự mở rộng thêm. Đọc tới đây thì khá là buồn, tuy nhiên Go thì không low-tech như C nên chúng ta được giới thiệu tới khái niệm &lt;strong&gt;&lt;em&gt;slice&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Slice là một structure wrap lại array để giúp việc thao tác với chúng dễ dàng hơn. Slice có 2 thuộc tính: &lt;em&gt;length&lt;/em&gt; và &lt;em&gt;capacity&lt;/em&gt;. Capacity chính là độ dài của array mà slice wrap lại, length là độ dài mà slice này biểu diễn. Length thì không thể lớn hơn capacity.&lt;/p&gt;
&lt;p&gt;Chúng ta chỉ thao tác được với các phần tử mà slice biểu diễn. Ví dụ ta có một slice với capacity 10, nhưng length là 0 thì gọi &lt;code class=&quot;language-text&quot;&gt;slice[0]&lt;/code&gt; sẽ xảy ra lỗi. Tuy nhiên việc wrap array bằng slice cộng thêm một mớ loằng ngoằng này đâu có giải quyết vấn đề độ dài fix cứng? Ừ, nhưng hàm &lt;code class=&quot;language-text&quot;&gt;append&lt;/code&gt; giải quyết được. &lt;code class=&quot;language-text&quot;&gt;append&lt;/code&gt; thêm một phần tử vào cuối slice, tăng length của nó thêm 1. Nếu length vượt quá capacity thì copy toàn bộ giá trị sang một array mới với length gấp đôi (tức capacity của slice tăng gấp đôi). Chỉ như vậy thôi là cuộc sống hạnh phúc hơn gấp trăm lần rồi =))&lt;/p&gt;
&lt;p&gt;Map trong Go là một cấu trúc dữ liệu kiểu dạng key-value, khá cơ bản. Key và value có thể là bất kì kiểu dữ liệu nào. Map tự mở rộng được, nhưng nên hạn chế điều này nếu chúng ta biết trước được số lượng key mà Map sẽ chứa. Key-value của map khi trong vòng lặp sẽ có thứ tự random, không cố định.&lt;/p&gt;
&lt;h2 id=&quot;4&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4&quot; aria-label=&quot;4 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4&lt;/h2&gt;
&lt;p&gt;Code trong Go được tổ chức theo package với root là &lt;code class=&quot;language-text&quot;&gt;$GOPATH/src/&lt;/code&gt;. Ở đầu file ta dùng keyword &lt;code class=&quot;language-text&quot;&gt;package&lt;/code&gt; để đặt cho nó một cái tên, khi &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; thì dùng complete path tính từ root. Go không cho phép việc 2 package import lẫn nhau (A import B và B import A). Để giải quyết điều này thì chúng ta phải tổ chức code cho tốt, tách phần code dùng chung ra các sub package con để import.&lt;/p&gt;
&lt;p&gt;Go cũng hỗ trợ việc public/private biến và hàm được export bởi package bằng một rule đơn giản: Nếu tên biến, tên hàm hoặc tên struct bắt đầu bằng một kí tự uppercase, nó được export.&lt;/p&gt;
&lt;p&gt;Trong Go có interface giống một số ngôn ngữ OOP khác. Tuy nhiên cú pháp định nghĩa một struct implement một interface được lược giản đi, và struct đó phải implement hết các method của interface. Struct cũng có thể implement nhiều interface cùng lúc. Một điểm thú vị là ta có thể viết một hàm nhận param là một empty interface: &lt;code class=&quot;language-text&quot;&gt;interface{}&lt;/code&gt;. Lúc này hàm sẽ nhận param với bất kì kiểu dữ liệu nào, vì tất cả các kiểu dữ liệu đều implement empty interface.&lt;/p&gt;
&lt;h2 id=&quot;5&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5&quot; aria-label=&quot;5 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5&lt;/h2&gt;
&lt;p&gt;Chương 5 giới thiệu về những phần cơ bản còn lại của Go mà chưa được nhắc tới. Tiêu biểu có một số phần khá hay như:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Error handling: Một common practice trong Go là return error thay vì throw error (dùng keyword &lt;code class=&quot;language-text&quot;&gt;panic&lt;/code&gt;). Cảm giác hơi lạ lạ khi không có try catch :v&lt;/li&gt;
&lt;li&gt;Defer: Một số trường hợp đọc file hoặc mở một connection, vì một lí do nào đó mà ta quên không gọi &lt;code class=&quot;language-text&quot;&gt;file.Close()&lt;/code&gt; chẳng hạn. Sử dụng &lt;code class=&quot;language-text&quot;&gt;defer&lt;/code&gt;, ví dụ &lt;code class=&quot;language-text&quot;&gt;defer file.Close()&lt;/code&gt; và đoạn code này sẽ được chạy cuối cùng trong hàm đó.&lt;/li&gt;
&lt;li&gt;Empty interface &amp;#x26; conversions: Ở các ngôn ngữ OOP, thường sẽ có 1 base class (như &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; trong Java) là superclass của mọi class khác. Go không có class, nhưng vẫn có một khái niệm là empty interface, là interface mà không có method nào. Mọi kiểu dữ liệu đều ngẫu nhiên implement interface này. Từ đó ta có thể viết hàm nhận và trả về biến có kiểu dữ liệu dynamic là empty interface này.&lt;/li&gt;
&lt;li&gt;Function type: Function trong Go cũng là first-class type (Yes!!! Giống JavaScript). Điều này có nghĩa là ta có thể truyền function vào một function khác và trả về function từ một function.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;6&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6&quot; aria-label=&quot;6 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6&lt;/h2&gt;
&lt;p&gt;Chương cuối của cuốn sách, &lt;strong&gt;&lt;em&gt;Concurrency&lt;/em&gt;&lt;/strong&gt;, giới thiệu hết sức cơ bản về concurrent programming với Go. Vì vậy mặc dù nắm bắt syntax thì nhanh nhưng những gì cuốn sách mang lại vẫn chưa làm mình thỏa mãn. Mình đã tìm đọc kha khá bài về concurrency trong Go, và bắt đầu thấy cả thuật ngữ &lt;em&gt;parallelism&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Nếu dịch ra tiếng Việt thì &lt;em&gt;concurrency&lt;/em&gt; là &lt;em&gt;đồng thời&lt;/em&gt; và &lt;em&gt;parallelism&lt;/em&gt; là &lt;em&gt;song song&lt;/em&gt;. Vì nghĩa của 2 từ trên khá gần nhau nên nhiều người (bao gồm cả mình) thường lầm tưởng chúng là một. Nhưng không! Hãy hiểu như thế này:&lt;/p&gt;
&lt;p&gt;“Bạn ngồi xem TV, tay thì nhắn tin với gấu và miệng thì nhâm nhi một tách trà. Có 3 việc ở đây: xem TV, nhắn tin, uống trà. Và chỉ có một mình bạn. Bạn làm cả 3 việc đồng thời với nhau, mỗi một thời điểm bạn chỉ làm được 1 việc. Đó là &lt;strong&gt;&lt;em&gt;concurrency&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Bây giờ hãy tưởng tượng bạn có bồ nhí ngồi bên cạnh, cùng xem TV với bạn, cùng… nhắn tin với gấu của bạn, cùng uống một tách trà với bạn. Có 2 người làm cùng 3 việc trên, đó là &lt;strong&gt;&lt;em&gt;parallelism&lt;/em&gt;&lt;/strong&gt;.”&lt;/p&gt;
&lt;p&gt;Như vậy, với một ngôn ngữ lập trình, ngay cả khi bạn chỉ có 1 core CPU, bạn vẫn có thể làm nhiều việc đồng thời cùng một lúc. Quay lại với câu chuyện concurrent programming với Go, bạn sẽ được giới thiệu tới khái niệm &lt;strong&gt;&lt;em&gt;goroutine&lt;/em&gt;&lt;/strong&gt;. Goroutine là một hàm có thể chạy xong xong với các hàm khác trong Go. Syntax các thứ được siêu tối giản để bạn không bao giờ phải lo việc đi khai báo hay phân vùng gì gì đó để code chạy được đồng thời. Goroutine cũng rất light-weight, được tối ưu tốt và không map trực tiếp vào thread của hệ điều hành. Vì vậy trong Go bạn có thể chạy đến hàng triệu goroutine cùng lúc. Đây là một trong những lí do vì sao Go được tung hô như vậy.&lt;/p&gt;
&lt;p&gt;Bài toán đau đầu với các ngôn ngữ multi-thread là shared memory (các biến dùng chung) cũng được Go xử lý gọn gàng bằng cách… đừng dùng nó nữa (khuyên bạn như vậy thôi, chứ Go vẫn support việc dùng chung biến). Thay vào đó, lại một khái niệm mới khác: &lt;strong&gt;&lt;em&gt;channel&lt;/em&gt;&lt;/strong&gt;. Các bạn lại hiểu như này:&lt;/p&gt;
&lt;p&gt;“Có 3 người: Lão Hạc, người đưa thư và nhân viên bưu điện. Lão Hạc viết thư xong rồi bỏ vào hòm thư. Người đưa thư đến lấy thư từ hòm và mang về bưu điện. Nhân viên bưu điện phân loại thư và gửi đi. Cả 3 đều làm việc đồng thời. Nếu nhân viên bưu điện làm năng suất quá, anh sẽ đợi một chút để nhân viên đưa thư mang những lá thư mới đến. Nếu Lão Hạc đi đến nhà Chí Phèo đòi nợ, nhân viên đưa thư sẽ ra về không và đợi đến lá thư sau của Lão. 3 người trên đại diện cho 3 goroutine, còn những lá thư là shared memory. Channel ở đây là những con đường dẫn từ nhà Lão Hạc đến bưu điện và đến bàn làm việc của nhân viên bưu điện, tóm lại là đường vận chuyển data.”&lt;/p&gt;
&lt;p&gt;Với một người đã quen với asynchronous programming như mình, concurrent programming với Go yêu cầu một mindset mới trong việc tiếp cận vấn đề. Cũng như các cụ đẻ ra Go đã có câu: &lt;em&gt;“Don’t communicate by sharing memory, share memory by communicating.”&lt;/em&gt; Đôi khi ta chỉ cần đứng dưới góc nhìn khác một chút là mọi chuyện đã trở nên dễ dàng hơn rồi.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[delete vs gán bằng undefined trong JavaScript]]></title><description><![CDATA[Đã bao giờ bạn xóa một property khỏi object trong JavaScript chưa? Bạn sử dụng cách nào? Bạn có muốn biết sự khác biệt giữa những cách đó? Bài viết này sẽ giúp bạn giải thích những thắc mắc trên.]]></description><link>https://duckwho.codes/posts/delete-vs-gan-bang-undefined-trong-javascript/</link><guid isPermaLink="false">https://duckwho.codes/posts/delete-vs-gan-bang-undefined-trong-javascript/</guid><pubDate>Wed, 27 Nov 2019 04:30:00 GMT</pubDate><content:encoded>&lt;p&gt;Hôm nay đang code thì mình gặp trường hợp phải xoá một property trong object. Thoạt nhìn tưởng đơn giản mà lại chứa đựng những kiến thức không ngờ. 😱&lt;/p&gt;
&lt;p&gt;Như các bạn đã biết, có 2 cách để “xoá” một property khỏi object trong JavaScript:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Dùng &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; operator&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; foo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bar&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Gán property cần xoá bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;foo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bar &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Sau một hồi Google thần chưởng, mình có thể tóm tắt lại những điểm khác biệt giữa 2 cách trên.&lt;/p&gt;
&lt;h2 id=&quot;1-gán-property-bằng-undefined-không-hoàn-toàn-xoá-property-đó&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-g%C3%A1n-property-b%E1%BA%B1ng-undefined-kh%C3%B4ng-ho%C3%A0n-to%C3%A0n-xo%C3%A1-property-%C4%91%C3%B3&quot; aria-label=&quot;1 gán property bằng undefined không hoàn toàn xoá property đó permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Gán property bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; không hoàn toàn xoá property đó&lt;/h2&gt;
&lt;p&gt;Điều đầu tiên bạn nên biết là việc gán &lt;code class=&quot;language-text&quot;&gt;foo.bar&lt;/code&gt; bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; chỉ đơn giản là cho property đó có giá trị là &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;. Có nghĩa là khi bạn sử dụng hàm &lt;code class=&quot;language-text&quot;&gt;hasOwnProperty()&lt;/code&gt; hoặc lặp object trong vòng lặp &lt;code class=&quot;language-text&quot;&gt;for in&lt;/code&gt; thì property vẫn còn tồn tại.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;foo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hasOwnProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;bar&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// returns true&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; key &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; foo&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;bar&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;I am still alive&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// log `I am still a live`&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nếu dùng &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; operator thì property sẽ bị xoá hoàn toàn, và kết quả trong đoạn code trên sẽ bị đảo ngược.&lt;/p&gt;
&lt;p&gt;Lí do là vì &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; operator làm thay đổi &lt;a href=&quot;https://thefullsnack.com/posts/javascript-v8-notes.html#hidden-class&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;hidden class&lt;/a&gt;, tương đương với việc property &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt; chưa bao giờ được khai báo. Điều này không xảy ra khi gán &lt;code class=&quot;language-text&quot;&gt;foo.bar&lt;/code&gt; bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;, vì thao tác này chỉ gán lại giá trị của property &lt;code class=&quot;language-text&quot;&gt;bar&lt;/code&gt;. Vì vậy nếu bạn muốn check trong object có tồn tại property nào đó không thì nên sử dụng hàm &lt;code class=&quot;language-text&quot;&gt;hasOwnProperty()&lt;/code&gt; hơn là một câu check đơn giản:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;foo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bar &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Các bạn thử tìm hiểu sự khác biệt giữa &lt;em&gt;undefined&lt;/em&gt; và &lt;em&gt;not defined&lt;/em&gt; trong JavaScript nữa nhé, khá thú vị đấy! 😉&lt;/p&gt;
&lt;h2 id=&quot;2-nếu-object-có-prototype-chain-thì-sao&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-n%E1%BA%BFu-object-c%C3%B3-prototype-chain-th%C3%AC-sao&quot; aria-label=&quot;2 nếu object có prototype chain thì sao permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Nếu object có prototype chain thì sao?&lt;/h2&gt;
&lt;p&gt;Mình có một ví dụ như sau:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; origin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    x&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; extended &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;origin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
extended&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; extended&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;extended&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// ???&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Các bạn thử đoán xem đoạn code trên sẽ log ra cái gì?&lt;/p&gt;
&lt;p&gt;Nếu bạn nghĩ kết quả là &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; thì xin chia buồn, hôm nay bạn tạch lô =))&lt;/p&gt;
&lt;p&gt;Ở đây chúng ta có object &lt;code class=&quot;language-text&quot;&gt;extended&lt;/code&gt; có prototype là object &lt;code class=&quot;language-text&quot;&gt;origin&lt;/code&gt;. Sau khi gọi &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; thì mỗi lần truy cập lại &lt;code class=&quot;language-text&quot;&gt;extended.x&lt;/code&gt; JavaScript engine sẽ look up từ prototype chain của &lt;code class=&quot;language-text&quot;&gt;extended&lt;/code&gt; và tìm thấy property &lt;code class=&quot;language-text&quot;&gt;x&lt;/code&gt; của &lt;code class=&quot;language-text&quot;&gt;origin&lt;/code&gt;. Kết quả trả về console là &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;OK đã rõ, vậy điều gì sẽ xảy ra khi thay 2 dòng cuối của đoạn code trên thành như sau:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;extended&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;extended&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// ???&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lúc này kết quả log ra sẽ là &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;. Vì property &lt;code class=&quot;language-text&quot;&gt;x&lt;/code&gt; vẫn tồn tại trong &lt;code class=&quot;language-text&quot;&gt;extended&lt;/code&gt; với giá trị bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; nên sẽ không xảy ra việc look up từ prototype chain.&lt;/p&gt;
&lt;p&gt;Túm lại là khi bạn thực hiện “xoá” một property khỏi object, nếu không chắc chắn rằng object đó có prototype chain hay không và các object nó thừa hưởng prototype có chứa property cần xoá không, thì bạn nên gán nó bằng &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; thay vì dùng &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; operator.&lt;/p&gt;
&lt;h2 id=&quot;3-tôi-có-một-con-máy-linux-với-cpu-08ghz-và-256mb-ram-tôi-quan-tâm-tới-performance&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-t%C3%B4i-c%C3%B3-m%E1%BB%99t-con-m%C3%A1y-linux-v%E1%BB%9Bi-cpu-08ghz-v%C3%A0-256mb-ram-t%C3%B4i-quan-t%C3%A2m-t%E1%BB%9Bi-performance&quot; aria-label=&quot;3 tôi có một con máy linux với cpu 08ghz và 256mb ram tôi quan tâm tới performance permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. “Tôi có một con máy Linux với CPU 0.8GHz và 256MB RAM, tôi quan tâm tới performance!”&lt;/h2&gt;
&lt;p&gt;Như đã đề cập ở phần 1, việc &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; một property sẽ làm thay đổi hidden class, đồng nghĩa với performance bị ảnh hưởng. Bạn nên tránh sử dụng &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt; operator quá nhiều, đặc biệt ở trong vòng lặp. Tuy nhiên không có nghĩa là bạn không bao giờ nên dùng operator này. Việc optimize code ở mức JavaScript engine sẽ không đáng để đánh đổi nếu nó làm cho code của bạn đọc như văn tế.&lt;/p&gt;
&lt;p&gt;Bài viết này đã giúp bạn hiểu được sự khác biệt giữa 2 cách xóa property khỏi object trong JavaScript. Hi vọng nó sẽ giúp bạn lên level để đi cà khịa với đồng nghiệp. 😎&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Tham khảo từ:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://stackoverflow.com/a/14967568/8943850&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;javascript - delete a.x vs a.x = undefined - Stack Overflow&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;&lt;a href=&quot;https://thefullsnack.com/posts/javascript-v8-notes.html#hidden-class&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Vài ghi chép về V8 và Garbage Collection | Huy’s Blog&lt;/a&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>